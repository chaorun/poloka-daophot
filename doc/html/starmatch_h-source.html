<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>starmatch.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.6 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; <a class="qindexRef" doxygen="_cgi:http://ici.la.bas/toto/tata/search.cgi" href="http://ici.la.bas/toto/tata/search.cgi">Search</a> &nbsp; </center>
<hr><h1>starmatch.h</h1><a href="starmatch_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">// This may look like C code, but it is really -*- C++ -*-</font>
00002 <font class="preprocessor">#ifndef  STARMATCH__H </font>
00003 <font class="preprocessor"></font><font class="preprocessor">#define  STARMATCH__H</font>
00004 <font class="preprocessor"></font>
00005 <font class="preprocessor">#include &lt;iostream&gt;</font>
00006 <font class="preprocessor">#include &lt;iterator&gt;</font> <font class="comment">// for ostream_iterator</font>
00007 <font class="preprocessor">#include &lt;algorithm&gt;</font> <font class="comment">// for swap</font>
00008 <font class="preprocessor">#include &lt;string&gt;</font>
00009 
00010 <font class="preprocessor">#include "<a class="code" href="point_h.html">point.h</a>"</font>
00011 <font class="preprocessor">#include "<a class="code" href="basestar_h.html">basestar.h</a>"</font>
00012 <font class="preprocessor">#include "<a class="code" href="gtransfo_h.html">gtransfo.h</a>"</font>
00013 
00014 
00022 
00023 
<a name="l00029"></a><a class="code" href="class_starmatch.html">00029</a> <font class="keyword">class </font><a class="code" href="class_starmatch.html">StarMatch</a> 
00030 #ifdef USE_ROOT
00031   : <font class="keyword">public</font> TObject
00032 #endif <font class="comment">/*USE_ROOT */</font>
00033 {
00034 
00035 <font class="keyword">friend</font> <font class="keyword">class </font>StarMatchList;
00036 
00037   <font class="keyword">public</font>: <font class="comment">/* if one sets that private, then fitting routines will be a nightmare. we could set all the Transfo classes friend... */</font>
00038 
<a name="l00039"></a><a class="code" href="class_starmatch.html#m1">00039</a>   <a class="code" href="class_point.html">Point</a> point1, point2; 
<a name="l00040"></a><a class="code" href="class_starmatch.html#m3">00040</a>   <a class="code" href="class_countedref.html">BaseStarRef</a> s1, s2; 
00041 <font class="keywordtype">double</font> distance;
00042 
00043   <font class="keyword">public</font> :
00044 
00046 
<a name="l00048"></a><a class="code" href="class_starmatch.html#a0">00048</a>   StarMatch(<font class="keyword">const</font> <a class="code" href="class_point.html">Point</a> &amp;p1, <font class="keyword">const</font> <a class="code" href="class_point.html">Point</a> &amp;p2, <font class="keyword">const</font> <a class="code" href="class_basestar.html">BaseStar</a> *S1, <font class="keyword">const</font> <a class="code" href="class_basestar.html">BaseStar</a> *S2) : 
00049     point1(p1), point2(p2), s1(S1), s2(S2), distance(0.)
00050   {};
00051 
00052   <font class="comment">// the next one would require that StarMatch knows BaseStar which is not mandatory for StarMatch to work</font>
00053   <font class="comment">// StarMatch(BaseStar *S1, BaseStar *S2) : point1(*S1), point2(*S2), s1(S1), s2(S2) {};</font>
00054 
<a name="l00056"></a><a class="code" href="class_starmatch.html#a1">00056</a>   <font class="keywordtype">double</font> Distance(<font class="keyword">const</font> <a class="code" href="class_gtransfo.html">Gtransfo</a> &amp;T)<font class="keyword"> const </font>{ <font class="keywordflow">return</font>  point2.<a class="code" href="class_point.html#a1">Distance</a>(T.<a class="code" href="class_gtransfo.html#a1">apply</a>(point1)); };
00057 
<a name="l00059"></a><a class="code" href="class_starmatch.html#a2">00059</a>   <font class="keywordtype">void</font> SetDistance(<font class="keyword">const</font> <a class="code" href="class_gtransfo.html">Gtransfo</a> &amp;T)<font class="keyword"> </font>{ distance = Distance(T);};
<a name="l00061"></a><a class="code" href="class_starmatch.html#a3">00061</a>   <font class="keywordtype">double</font> Distance()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> distance;}
00062 
00063   <font class="keywordtype">void</font> Swap()<font class="keyword"> </font>{ swap(point1, point2) ; swap(s1,s2) ; }
00064 
00065 
00066  <font class="keyword">friend</font> <font class="keywordtype">bool</font> DecFlux(<font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp; S1, <font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp; S2)<font class="keyword"></font>
00067 <font class="keyword">  </font>{<font class="keywordflow">return</font>(S1.s1-&gt;flux &gt; S2.s1-&gt;flux); }
00068   <font class="keyword">friend</font> <font class="keywordtype">bool</font> IncreasingDistances(<font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;one, <font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;two)<font class="keyword"> </font>{ <font class="keywordflow">return</font>(one.distance &lt; two.distance);}
00069   <font class="keyword">friend</font> <font class="keywordtype">bool</font> DecreasingDistances(<font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;one, <font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;two)<font class="keyword"> </font>{ <font class="keywordflow">return</font>(one.distance &gt; two.distance);}
00070   
00071 <font class="comment">/* comparison that ensures that after a sort, duplicates are next one another */</font>
00072 
00073   <font class="keyword">explicit</font> StarMatch()<font class="keyword"> </font>{};
00074 
00075   <font class="keyword">friend</font> ostream&amp; <a class="code" href="starmatch_h.html#a3">operator &lt;&lt; </a>(ostream &amp;stream, <font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;Match); 
00076 
00077   ~StarMatch()<font class="keyword"> </font>{}
00078 
00079 
00080  <font class="keyword">private</font>:
00081   <font class="comment">//  bool operator &lt;  (const StarMatch &amp; other) const { return (s1 &gt; other.s1) ? s1 &gt; other.s1 : s2 &gt; other.s2;}</font>
00082  
00083   <font class="comment">/* for unique to remove duplicates */</font>
00084   <font class="keywordtype">bool</font> operator == (<font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;other)<font class="keyword"> const </font>{ <font class="keywordflow">return</font> (s1 == other.s1 &amp;&amp; s2 == other.s2); };
00085   <font class="keywordtype">bool</font> operator != (<font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;other)<font class="keyword"> const </font>{ <font class="keywordflow">return</font> (s1 != other.s1 || s2 != other.s2); };
00086 
00087   <font class="keyword">friend</font> <font class="keywordtype">bool</font> CompareS1(<font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;one, <font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;two)<font class="keyword"></font>
00088 <font class="keyword">    </font>{ <font class="keywordflow">return</font> ((one.s1 == two.s1) ? (one.distance &lt; two.distance) : ( (<font class="keyword">const</font> <a class="code" href="class_basestar.html">BaseStar</a>*) one.s1 &gt; (<font class="keyword">const</font> <a class="code" href="class_basestar.html">BaseStar</a> *) two.s1));}
00089   <font class="keyword">friend</font> <font class="keywordtype">bool</font> SameS1(<font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;one, <font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;two)<font class="keyword"></font>
00090 <font class="keyword">    </font>{ <font class="keywordflow">return</font> (one.s1 ==  two.s1);}
00091 
00092   <font class="keyword">friend</font> <font class="keywordtype">bool</font> CompareS2(<font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;one, <font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;two)<font class="keyword"></font>
00093 <font class="keyword">    </font>{ <font class="keywordflow">return</font> ((one.s2 == two.s2) ? (one.distance &lt; two.distance) : ((<font class="keyword">const</font> <a class="code" href="class_basestar.html">BaseStar</a> *)one.s2 &gt; (<font class="keyword">const</font> <a class="code" href="class_basestar.html">BaseStar</a> *) two.s2));}
00094   <font class="keyword">friend</font> <font class="keywordtype">bool</font> SameS2(<font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;one, <font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;two)<font class="keyword"></font>
00095 <font class="keyword">    </font>{ <font class="keywordflow">return</font> (one.s2 ==  two.s2);}
00096 
00098 
00099   ClassDef(<a class="code" href="class_starmatch.html">StarMatch</a>,1);
00100 };
00101 
00102 <font class="comment">/* =================================== StarMatchList ============================================================ */</font>
00103 
00104 ostream&amp; <a class="code" href="starmatch_h.html#a3">operator &lt;&lt; </a>(ostream &amp;stream, <font class="keyword">const</font> <a class="code" href="class_starmatch.html">StarMatch</a> &amp;Match);
00105 
00106 
00107 <font class="keyword">typedef</font> list&lt;StarMatch&gt;::iterator StarMatchIterator;
00108 <font class="keyword">typedef</font> list&lt;StarMatch&gt;::const_iterator StarMatchCIterator;
00109 
00111 
00118 ostream&amp; <a class="code" href="starmatch_h.html#a3">operator &lt;&lt; </a>(ostream &amp;stream, <font class="keyword">const</font> StarMatchList &amp;List);
00119 
00120 
00121 <font class="keyword">class </font>StarMatchList : <font class="keyword">public</font> list&lt;StarMatch&gt;
00122 #ifdef USE_ROOT
00123 , <font class="keyword">public</font> TObject
00124 #endif
00125 {
00126 
00127 
00128   <font class="keyword">private</font> :
00129   <font class="keywordtype">int</font> nused;
00130   <font class="keywordtype">int</font> order;
00131   <font class="keywordtype">double</font> chi2;
00132   <a class="code" href="class_gtransfo.html">Gtransfo</a> *transfo;
00133 
00134 
00135 
00136   <font class="keyword">public</font> :
00137 
00138 
00139   <font class="comment">/* constructor */</font>
00140   StarMatchList() : nused(0), order(0), chi2(0), transfo(0) {};
00141 
00143 
00144   <font class="keywordtype">void</font> RefineTransfo(<font class="keyword">const</font> <font class="keywordtype">double</font> &amp;NSigmas, <font class="keyword">const</font> <a class="code" href="class_gtransfo.html">Gtransfo</a>* PriorTransfo = NULL);
00145 
00147 
00148   <a class="code" href="class_gtransfo.html">Gtransfo</a> *Transfo()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> transfo;}
00149 
00151   <font class="keywordtype">double</font> Chi2()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> chi2;}
00152 
00154   <font class="keywordtype">void</font> SetChi2();
00155 
00157   <font class="keywordtype">int</font> Nused()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> nused;}
00158   
00159 
00161   <font class="keywordtype">int</font> Dof()<font class="keyword"> const </font>{<font class="keywordflow">return</font> (2*nused &gt; transfo-&gt;<a class="code" href="class_gtransfo.html#a14">Npar</a>())? (2 *nused-transfo-&gt;<a class="code" href="class_gtransfo.html#a14">Npar</a>()): 0;}
00162 
00164   <font class="keywordtype">int</font> TransfoOrder()<font class="keyword"> const </font>{<font class="keywordflow">return</font> order;}
00165 
00166   
00168     <font class="keywordtype">void</font> Swap () ;
00169 
00171   <font class="keywordtype">double</font> Residual()<font class="keyword"> const </font>{ <font class="keywordflow">if</font> (nused != 0) <font class="keywordflow">return</font> sqrt(chi2/nused); <font class="keywordflow">else</font> <font class="keywordflow">return</font> -1;}
00172 
00173   <font class="keywordtype">int</font> Cleanup(<font class="keywordtype">double</font> DistanceCut, <font class="keyword">const</font> <a class="code" href="class_gtransfo.html">Gtransfo</a> &amp;Transfo);
00174 
00177   <font class="keywordtype">int</font> RemoveAmbiguities(<font class="keyword">const</font> <a class="code" href="class_gtransfo.html">Gtransfo</a> &amp;Transfo);
00178   
00180   <font class="keywordtype">double</font> MedianDist2() <font class="keyword">const</font>;
00181   
00183   <font class="keywordtype">void</font> SetTransfo(<font class="keyword">const</font> <a class="code" href="class_gtransfo.html">Gtransfo</a> *Transfo)<font class="keyword"> </font>{ <font class="keywordflow">if</font> (transfo) <font class="keyword">delete</font> transfo; transfo = Transfo-&gt;<a class="code" href="class_gtransfo.html#a7">Clone</a>();}
00185   <font class="keywordtype">void</font> SetTransfo(<font class="keyword">const</font> <a class="code" href="class_gtransfo.html">Gtransfo</a> &amp;Transfo)<font class="keyword"> </font>{ <font class="keywordflow">if</font> (transfo) <font class="keyword">delete</font> transfo; transfo = Transfo.<a class="code" href="class_gtransfo.html#a7">Clone</a>();}
00186 
00188   <font class="keywordtype">void</font> SetTransfoOrder(<font class="keyword">const</font> <font class="keywordtype">int</font> Order);
00189 
00192   <a class="code" href="class_gtransfo.html">Gtransfo</a> *InverseTransfo();
00193 
00194 
00196   <font class="keywordtype">void</font> SetDistance(<font class="keyword">const</font> <a class="code" href="class_gtransfo.html">Gtransfo</a> &amp;Transfo);
00197 
00199   <font class="keywordtype">void</font> CutTail(<font class="keyword">const</font> <font class="keywordtype">int</font> NKeep);
00200 
00202   <font class="keywordtype">void</font> DumpTransfo(ostream &amp;stream = cout) <font class="keyword">const</font>;
00203 
00204   ~StarMatchList()<font class="keyword"> </font>{ <font class="keywordflow">if</font> (transfo) <font class="keyword">delete</font> transfo;}
00205   
00207     <font class="keywordtype">void</font> write(<font class="keyword">const</font> string &amp;filename) <font class="keyword">const</font> ;
00208     <font class="keywordtype">void</font> write(ostream &amp; pr=cout ) <font class="keyword">const</font> ;
00209 
00210 
00212   <font class="keywordtype">void</font> write(<font class="keyword">const</font> <a class="code" href="class_gtransfo.html">Gtransfo</a> &amp;tf, <font class="keyword">const</font> string &amp;filename) <font class="keyword">const</font> ;
00213   <font class="keywordtype">void</font> write(<font class="keyword">const</font> <a class="code" href="class_gtransfo.html">Gtransfo</a> &amp;tf, ostream &amp; pr) <font class="keyword">const</font>;
00214 
00215 
00216 
00217 
00219   <font class="keywordtype">void</font> dump(ostream &amp; stream = cout)<font class="keyword"> const </font>{ stream &lt;&lt; *<font class="keyword">this</font>; }
00220 
00221   ClassDef(StarMatchList,1)
00222 
00223     <font class="keyword">private</font>:
00224 
00225   StarMatchList(<font class="keyword">const</font> StarMatchList&amp;); <font class="comment">// copies nor properly handled </font>
00226   <font class="keywordtype">void</font> operator=(<font class="keyword">const</font> StarMatchList&amp;);
00227 
00228 
00229 };
00230 
00231 
00232 
00233 <font class="preprocessor">#endif </font><font class="comment">/* STARMATCH__H */</font>
</pre></div><hr><address><small>Generated at Sun Feb 8 18:22:49 2004 for toads by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.6 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
