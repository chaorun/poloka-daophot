<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>psf.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.6 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; <a class="qindexRef" doxygen="_cgi:http://ici.la.bas/toto/tata/search.cgi" href="http://ici.la.bas/toto/tata/search.cgi">Search</a> &nbsp; </center>
<hr><h1>psf.h</h1><div class="fragment"><pre>00001 <font class="comment">// This may look like C code, but it is really -*- C++ -*-</font>
00002 
00003 
00004 <font class="comment">/* DOC Definition of a PSF: it inherits from GeneralPSF2D, defined in</font>
00005 <font class="comment">fct2dfit.h. GeneralPSF2D is a GeneralFunction daughter, at 2-Dimension`, and for wich the parameters Param are always classified in the order x, y, flux, other paramaters.</font>
00006 <font class="comment"></font>
00007 <font class="comment">The different function that can be </font>
00008 <font class="comment">used as a PSF are defined in fct2dfit.h.</font>
00009 <font class="comment"></font>
00010 <font class="comment">Definition of PSFStar: (SEStar daughter, + PSF) = a star</font>
00011 <font class="comment">with a PSF </font>
00012 <font class="comment"></font>
00013 <font class="comment">Definition of PSFFitStar:</font>
00014 <font class="comment"> (PSFStar Daughter, + Error Vector for a fit) = </font>
00015 <font class="comment">a star to be fitted</font>
00016 <font class="comment"></font>
00017 <font class="comment">Associated StarList are also defined.</font>
00018 <font class="comment"></font>
00019 <font class="comment">*/</font>
00020 
00021 
00022 <font class="preprocessor">#ifndef PSF_SEEN</font>
00023 <font class="preprocessor"></font><font class="preprocessor">#define PSF_SEEN</font>
00024 <font class="preprocessor"></font>
00025 
00026 <font class="preprocessor">#include "<a class="code" href="image_h.html">image.h</a>"</font>
00027 <font class="preprocessor">#include "<a class="code" href="sestar_h.html">sestar.h</a>"</font>
00028 
00029 <font class="comment">//#include "fct1dfit.h"</font>
00030 <font class="preprocessor">#include "fct2dfit.h"</font>    
00031 <font class="comment">//#include "machine.h" /* for Int_4 */</font>
00032 
00033 <font class="comment">// star qui herite de SEStar, donc a priori en coordonnees SE</font>
00034 <font class="comment">// !!!! les routines de Add considere que la star est en XY</font>
00035 <font class="comment">// les routines de fit retourne des coordonnees en  XY</font>
00036 
00037 
00038 
00039 
00040 
00041 
00042 
00043 
00044 <font class="comment">//********************   DEFINITION PSF   *********************</font>
00045 <font class="comment">/* The sole reasonable use of all this stuff is for simulation</font>
00046 <font class="comment">of images, or to add fakes to real images. But anyway, do not</font>
00047 <font class="comment">consider any serious simulation work without redesigning all that.</font>
00048 <font class="comment">  In my view, one should really consider throwing all that stuff away:</font>
00049 <font class="comment">It is far too complicated (a few thousand lines in total) to essentialy </font>
00050 <font class="comment">add Gaussians to images. I also suspect that all that code is not efficient.</font>
00051 <font class="comment"></font>
00052 <font class="comment">P. Astier.</font>
00053 <font class="comment">*/</font>
00054 
00055 
00056 
00057 
00058 
00059 <font class="keyword">class </font>FuncPtrGFF : <font class="keyword">public</font> GeneralPSF2D {
00060 <font class="keyword">public</font>:
00061   <font class="keyword">typedef</font> double (*Func)(<font class="keywordtype">double</font> dx, <font class="keywordtype">double</font> dy, <font class="keywordtype">double</font> <font class="keyword">const</font>* par);
00062   FuncPtrGFF(Func f, <font class="keywordtype">int</font> nPar);
00063   <font class="keyword">virtual</font>        ~FuncPtrGFF();
00064   <font class="keyword">virtual</font> <font class="keywordtype">double</font>  Value(<font class="keywordtype">double</font> <font class="keyword">const</font> xp[], <font class="keywordtype">double</font> <font class="keyword">const</font>* parm);
00065   
00066 <font class="keyword">protected</font>:
00067   Func            mFunc;
00068   <font class="keywordtype">int</font>             mNPar;
00069   <font class="keywordtype">double</font>*                 mTmpParm;
00070 <font class="keyword">private</font>:
00071   FuncPtrGFF(<font class="keyword">const</font> FuncPtrGFF &amp;);
00072   FuncPtrGFF &amp; operator=( <font class="keyword">const</font> FuncPtrGFF  &amp;);
00073 
00074 };
00075 
00076 
00077 <font class="comment">//</font>
00078 <font class="comment">// Une PSF est toujours associee a une GeneralFunction.</font>
00079 <font class="comment">//</font>
00080 
00081 <font class="comment">// la creation d'une PSF avec les types ci-dessous est </font>
00082 <font class="comment">// geree comme celle d'un singleton</font>
00083 <font class="comment">// cela permet de l'utiliser ds les PSFStar, </font>
00084 <font class="comment">// ou la PSF n'est pas deletee par le destructeur</font>
00085 
00086 
00087 <font class="keyword">class </font>PSF {
00088 <font class="keyword">public</font>:
00089 
00090   <font class="comment">/*DOC {\bf Different kind of PSF are pre-defined}:\\</font>
00091 <font class="comment">{\tt  enum PSFKind} {\\</font>
00092 <font class="comment">   {\tt  psfCustom = 0}, (i.e. non pre-defined-type)\\ </font>
00093 <font class="comment">    {\tt   psfGaussienne = 1},\\</font>
00094 <font class="comment">    {\tt   psfGaussInteg},</font>
00095 <font class="comment">    {\tt   psfDelGaussienne},\\</font>
00096 <font class="comment">     {\tt  psfDelGaussinteg},</font>
00097 <font class="comment">    {\tt   psfDel1Gaussienne},\\</font>
00098 <font class="comment">     {\tt  psfDel1GaussInteg},</font>
00099 <font class="comment">     {\tt  psfMoffat},\\</font>
00100 <font class="comment">     {\tt  psfMoffInteg},</font>
00101 <font class="comment">     {\tt  psfDel2Gaussienne},\\</font>
00102 <font class="comment">     {\tt  psfDel2GaussInteg}</font>
00103 <font class="comment">  }; */</font>
00104 
00105 
00106   <font class="keyword">enum</font> PSFKind{
00107     psfCustom = 0, <font class="comment">// PSF de type non determinee, perso par ex.</font>
00108       psfGaussienne = 1,
00109       psfGaussInteg,
00110       psfDelGaussienne,
00111       psfDelGaussinteg,
00112       psfDel1Gaussienne,
00113       psfDel1GaussInteg,
00114       psfMoffat,
00115       psfMoffInteg,
00116       psfDel2Gaussienne,
00117       psfDel2GaussInteg
00118   };
00119   
00120   <font class="comment">/*DOCF  allocation with pre-defined type.</font>
00121 <font class="comment">   The PSF is then a singleton object (one allocation per pre-defined type one main program). */</font>
00122   PSF(<font class="keywordtype">int</font> psfKind, <font class="keywordtype">double</font> ns=3); 
00123 
00124 
00125   <font class="comment">/*DOCF  allocation with an already existing PSF.</font>
00126 <font class="comment">No singleton management.*/</font>
00127   PSF(GeneralPSF2D *psf2d, <font class="keywordtype">double</font> ns=3);
00128   PSF(FuncPtrGFF::Func f, <font class="keywordtype">int</font> nPar, <font class="keywordtype">double</font> ns=3);
00129   <font class="keyword">virtual</font>        ~PSF();
00130   
00131   <font class="comment">/*DOCF returns PSF kind. */</font>
00132   <font class="keywordtype">int</font>           Kind()<font class="keyword"> const </font>{<font class="keywordflow">return</font> mTypePSF;}
00133 
00134   <font class="comment">/*DOC {\tt Value(double x, double y, double const* parV)}: </font>
00135 <font class="comment">returns PSF value. */</font>
00136   <font class="keyword">virtual</font> <font class="keywordtype">double</font>  Value(<font class="keywordtype">double</font> x, <font class="keywordtype">double</font> y, <font class="keywordtype">double</font> <font class="keyword">const</font>* parV) <font class="keyword">const</font>;
00137     
00138    <font class="comment">/*DOCF returns PSF number of parameter. */</font>
00139  <font class="keywordtype">int</font>             NParm()<font class="keyword"> const       </font>{<font class="keywordflow">return</font> mNParm;}
00140   <font class="comment">/* returns the associated General Function */</font>
00141  GeneralPSF2D* GetGFF()<font class="keyword"> </font>{<font class="keywordflow">return</font> mGFF;}
00142  
00143 <font class="keyword">friend</font> <font class="keyword">class </font>PSFStar;
00144 
00145 <font class="keyword">protected</font>:
00146   PSF(<font class="keywordtype">void</font>);              <font class="comment">// Pour relire une PSFStar</font>
00147 
00148   <font class="keywordtype">int</font>  mTypePSF;
00149   <font class="keywordtype">int</font>  mNParm;          <font class="comment">// Total, y compris x,y,fond_fit,flux.</font>
00150   <font class="keywordtype">float</font>    mNSig0;          <font class="comment">// nb de sigmas pour negliger dans les images</font>
00151                           <font class="comment">// simulees</font>
00152  
00153   GeneralPSF2D* mGFF;
00154   <font class="keywordtype">void</font>  MakeStdGFF();
00155 
00156 <font class="keyword">private</font>:
00157   <font class="comment">// pour gerer l'allocation d'une seule PSF par type pre-defini</font>
00158   <font class="keyword">static</font> GeneralPSF2D* _instance[10] ; <font class="comment">// autant que de enum != 0 </font>
00159  
00160   PSF(<font class="keyword">const</font> PSF &amp;);
00161   PSF&amp; operator=(<font class="keyword">const</font> PSF &amp;); 
00162   
00163  };
00164 
00165 
00166 <font class="comment">//********************   FIN DEFINITION PSF   *********************</font>
00167 
00168 
00169 <font class="comment">//********************   DEFINITION PSFStar   *********************</font>
00170 
00171 
00172 
00173 
00174 
00175 
00176 <font class="comment">// Une etoile avec une PSF.</font>
00177 <font class="comment">// Plusieurs etoiles peuvent partager la meme PSF</font>
00178 
00179 <font class="keyword">class </font>PSFStar : <font class="keyword">public</font> <a class="code" href="class_sestar.html">SEStar</a> {
00180 
00181   <font class="comment">/*DOC A SExtractor star with a PSF. Mainly for Monte-Carlo simulation. */</font>
00182 
00183 <font class="keyword">public</font>:
00184   <font class="comment">/*DOCF creation of a "blank" star, the PSF is given */</font>
00185   PSFStar(PSF* psf=NULL);
00186   <font class="comment">/*DOC {\tt   PSFStar(SEStar const &amp; sestar, </font>
00187 <font class="comment">PSF* psf=NULL)}: copy of the SEStar, </font>
00188 <font class="comment">the given PSF is added */</font>
00189   PSFStar(<a class="code" href="class_sestar.html">SEStar</a> <font class="keyword">const</font> &amp; sestar, PSF* psf=NULL);
00190   PSFStar(<font class="keywordtype">double</font> xx, <font class="keywordtype">double</font> yy, <font class="keywordtype">double</font> ampl, PSF* psf=NULL);
00191   PSFStar(PSFStar <font class="keyword">const</font> &amp; star);
00192   <font class="keyword">virtual</font>        ~PSFStar();
00193 
00194   <font class="comment">/* DOCF : background  */</font>
00195   <font class="keywordtype">double</font>&amp;         Fond_fit()<font class="keyword">        </font>{<font class="keywordflow">return</font> fond_fit;}
00196   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   Fond_fit()<font class="keyword"> const  </font>{<font class="keywordflow">return</font> fond_fit;}
00197  
00198   <font class="comment">/* DOCF : PSF function value */</font>
00199 <font class="keyword">virtual</font> <font class="keywordtype">double</font>  operator() (<font class="keywordtype">double</font> xx, <font class="keywordtype">double</font> yy) <font class="keyword">const</font>;
00200   <font class="comment">/* DOCF : PSF vector parameters */</font>
00201   <font class="keywordtype">double</font>&amp;         Parm(<font class="keywordtype">int</font> i)<font class="keyword">        </font>{<font class="keywordflow">return</font> mParm[i];}
00202   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   Parm(<font class="keywordtype">int</font> i)<font class="keyword"> const  </font>{<font class="keywordflow">return</font> mParm[i];}
00203   <font class="comment">/* DOCF : PSF Sigma X value */</font>
00204   <font class="keywordtype">double</font>&amp;         SigX()<font class="keyword">       </font>{<font class="keywordflow">return</font> mParm[3];}
00205   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   SigX()<font class="keyword"> const </font>{<font class="keywordflow">return</font> mParm[3];}
00206   <font class="comment">/* DOCF : PSF Sigma Y value */</font>
00207  <font class="keywordtype">double</font>&amp;         SigY()<font class="keyword">       </font>{<font class="keywordflow">return</font> mParm[4];}
00208   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   SigY()<font class="keyword"> const </font>{<font class="keywordflow">return</font> mParm[4];}
00209   <font class="comment">/* DOCF : PSF Rho value */</font>
00210  <font class="keywordtype">double</font>&amp;         Rho()<font class="keyword">        </font>{<font class="keywordflow">return</font> mParm[5];}
00211   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   Rho()  <font class="keyword">const</font> {<font class="keywordflow">return</font> mParm[5];}
00212   <font class="keywordtype">double</font>          Sig()<font class="keyword"> const  </font>{<font class="keywordflow">return</font> sqrt(mParm[3]*mParm[3] + mParm[4]*mParm[4]);}
00213   <font class="comment">/*DOC </font>
00214 <font class="comment">For the sake of convenience, some of the {\tt Parm(i)}</font>
00215 <font class="comment">  have been renamed, as {\tt SigX, SigY, Rho, Fond_fit}. They are physically equivalent to {\tt Parm(3), (4), (5), (n-1)}.</font>
00216 <font class="comment">Changing {\tt SigX} value is equivalent to change </font>
00217 <font class="comment">{\tt Parm(3)} value.</font>
00218 <font class="comment">However, the star parameters as {\tt x, y, flux} </font>
00219 <font class="comment">{\em are not} are not re-named {\tt Parm(i)}.  </font>
00220 <font class="comment">They are different variables, although they correspond </font>
00221 <font class="comment">to the same quantities as {\tt Parm(0), (1), (2)}. </font>
00222 <font class="comment">Thus, setting the star </font>
00223 <font class="comment">position x and y won't change the associated </font>
00224 <font class="comment">PSF parameters {\tt Parm(0)} and {\tt Parm(1)}.</font>
00225 <font class="comment">This will be done only with calling the </font>
00226 <font class="comment">{\tt UpdParmVect()} method (see below). */</font>
00227 
00228 
00229   <font class="comment">/* DOCF PSF central (and not maximum) pixel value */</font>
00230  <font class="keyword">virtual</font> <font class="keywordtype">float</font>     PixMax()<font class="keyword"> const    </font>{<font class="keywordflow">return</font> (*this)(x,y);}
00231 
00232   <font class="comment">/* DOCF add the star to an image (for simulation) */</font>
00233   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    ImgAdd(<a class="code" href="class_image.html">Image</a>&amp; img) <font class="keyword">const</font>; 
00234   <font class="comment">/* DOCF add the star to an image (for simulation) */</font>
00235   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    ImgAdd_2(<a class="code" href="class_image.html">Image</a>&amp; img) <font class="keyword">const</font>; 
00236    <font class="comment">/* DOCF substract the star from an image */</font>
00237   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    ImgSub(<a class="code" href="class_image.html">Image</a>&amp; img) <font class="keyword">const</font>;
00238  
00239   <font class="comment">/* DOCF recover the star's PSF */</font>
00240   PSF*            GetPSF()<font class="keyword"> const </font>{<font class="keywordflow">return</font> mPSF;}
00241    <font class="comment">/* DOCF to set  star's PSF */</font>
00242  <font class="keywordtype">void</font>            SetPSF(PSF* psf);
00243   
00244    <font class="comment">/* DOCF to update the parameters {\tt Parm} </font>
00245 <font class="comment">used by the PSF from</font>
00246 <font class="comment">the parameters {\tt x, y, flux} of the star. */</font>
00247   <font class="keywordtype">void</font>            UpdParmVect()  <font class="keyword">const</font>;
00248    <font class="comment">/* DOCF update the parameters {\tt x, y, flux} of </font>
00249 <font class="comment">the star from</font>
00250 <font class="comment">the PSF parameters {\tt Parm}. */</font>
00251   <font class="keywordtype">void</font>            UpdFromParm() <font class="keyword">const</font>;
00252 
00253 <font class="comment">/*DOC read and write are similar to that of SEStar */</font>
00254   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    <a class="code" href="class_sestar.html#a75">dump</a>(ostream&amp; s=cout) <font class="keyword">const</font>;
00255   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    <a class="code" href="class_sestar.html#a74">dumpn</a>(ostream&amp; s=cout) <font class="keyword">const</font>;
00256 
00257   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    write(ostream&amp; s=cout) <font class="keyword">const</font>;
00258   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    <a class="code" href="class_sestar.html#a76">writen</a>(ostream&amp; s=cout)<font class="keyword">const</font> ;
00259 
00260  
00261    <font class="keyword">virtual</font> <font class="keywordtype">void</font>    Read(istream&amp; r, <font class="keyword">const</font> <font class="keywordtype">char</font> *Format, <font class="keywordtype">int</font> &amp;type_psf);
00262   <font class="comment">// creation of the PSFStar with the given PSF</font>
00263   <font class="keyword">static</font> PSFStar* <a class="code" href="class_sestar.html#d0">read</a>(istream&amp; r, <font class="keyword">const</font> <font class="keywordtype">char</font> *Format, PSF *mypsf);
00264   <font class="comment">// creation of the PSFStar with the type given in the list</font>
00265   <font class="keyword">static</font> PSFStar* <a class="code" href="class_sestar.html#d0">read</a>(istream&amp; r, <font class="keyword">const</font> <font class="keywordtype">char</font> *Format);
00266 
00268   <font class="comment">//  const char * WriteHeader_(ostream &amp; pr = cout, const char*i = NULL) const;</font>
00269   std::string WriteHeader_(ostream &amp; pr = cout, <font class="keyword">const</font> <font class="keywordtype">char</font>*i = NULL) <font class="keyword">const</font>; <font class="comment">// NRL 04/2004</font>
00270 
00271   
00272 <font class="keyword">protected</font>:
00273   PSF*            mPSF;
00274   <font class="keywordtype">double</font>*         mParm;
00275   <font class="keywordtype">double</font> fond_fit ;
00276 
00277 
00278 <font class="keyword">private</font>:
00279 
00280   PSFStar&amp; operator=(<font class="keyword">const</font> PSFStar &amp;); 
00281 
00282 };
00283 
00284 <a class="code" href="class_image.html">Image</a>&amp; operator += (<a class="code" href="class_image.html">Image</a>&amp; img, PSFStar <font class="keyword">const</font>&amp; psf);
00285 <a class="code" href="class_image.html">Image</a>&amp; operator -= (<a class="code" href="class_image.html">Image</a>&amp; img, PSFStar <font class="keyword">const</font>&amp; psf);
00286 
00287 
00288 
00289 <font class="comment">// PSFStarList definition(s) : </font>
00290 <font class="preprocessor">#include "starlist.h"</font>
00291 <font class="keyword">typedef</font> <a class="code" href="class_starlist.html">StarList&lt;PSFStar&gt;</a> <a class="code" href="class_starlist.html">PSFStarList</a>;
00292 <font class="comment">//typedef list&lt;PSFStar*&gt;::const_iterator PSFStarCIterator;</font>
00293 <font class="comment">//typedef list&lt;PSFStar*&gt;::iterator PSFStarIterator;</font>
00294 <font class="keyword">typedef</font> PSFStarList::const_iterator <a class="code" href="class_starlist.html">PSFStarCIterator</a>;
00295 <font class="keyword">typedef</font> PSFStarList::iterator <a class="code" href="class_starlist.html">PSFStarIterator</a>;
00296 <font class="keyword">typedef</font> <a class="code" href="class_countedref.html">CountedRef&lt;PSFStar&gt;</a> <a class="code" href="class_countedref.html">PSFStarRef</a>;
00297 
00298 <a class="code" href="class_starlist.html">BaseStarList</a>* PSF2Base(<a class="code" href="class_starlist.html">PSFStarList</a> * This);
00299 <font class="keyword">const</font> <a class="code" href="class_starlist.html">BaseStarList</a>* PSF2Base(<font class="keyword">const</font> <a class="code" href="class_starlist.html">PSFStarList</a> * This); 
00300 
00301 
00302 
00303 <font class="comment">//********************   FINDEFINITION PSFStar   *********************</font>
00304 
00305 
00306 <font class="comment">//********************   DEFINITION PSFFitStar   *********************</font>
00307 
00308 
00309 
00310 <font class="preprocessor">#ifdef IS_IT_USEFUL</font>
00311 <font class="preprocessor"></font>
00312 <font class="comment">// Une etoile pour faire des fits</font>
00313 <font class="keyword">class </font>PSFFitStar : <font class="keyword">public</font> PSFStar {
00314 <font class="comment">/* DOC A SEStar + PSF + method for fitting = a star for seeing computation ! */</font>
00315 
00316 <font class="keyword">public</font>:
00317 <font class="comment">/* DOC The creation can be made giving a PSF, a</font>
00318 <font class="comment">PSFStar, or a SEStar and a PSF.  */</font>
00319   PSFFitStar(PSF* psf=NULL);
00320   PSFFitStar(PSFFitStar <font class="keyword">const</font> &amp; star);
00321   PSFFitStar(PSFStar <font class="keyword">const</font> &amp; star);
00322   PSFFitStar(<a class="code" href="class_sestar.html">SEStar</a> <font class="keyword">const</font> &amp; star, PSF *psf);
00323 
00324   <font class="keyword">virtual</font>        ~PSFFitStar();
00325   
00326 <font class="comment">/* DOCF: error vector associated to the {\tt Parm} parameters</font>
00327 <font class="comment">vector. */</font>
00328   <font class="keywordtype">double</font>&amp;         Err(<font class="keywordtype">int</font> i)<font class="keyword">        </font>{<font class="keywordflow">return</font> mErr[i];}
00329   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   Err(<font class="keywordtype">int</font> i)<font class="keyword"> const  </font>{<font class="keywordflow">return</font> mErr[i];}
00330  <font class="comment">/* DOCF: error on flux  */</font>
00331  <font class="keywordtype">double</font>&amp;         ErrFlux()<font class="keyword">         </font>{<font class="keywordflow">return</font> mErr[0];}
00332   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   ErrFlux()  <font class="keyword">const</font>  {<font class="keywordflow">return</font> mErr[0];}
00333  <font class="comment">/* DOCF: error on x  */</font>
00334   <font class="keywordtype">double</font>&amp;         ErrX()<font class="keyword">            </font>{<font class="keywordflow">return</font> mErr[1];}
00335   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   ErrX()  <font class="keyword">const</font>     {<font class="keywordflow">return</font> mErr[1];}
00336   <font class="comment">/* DOCF: error on y */</font>
00337  <font class="keywordtype">double</font>&amp;         ErrY()<font class="keyword">            </font>{<font class="keywordflow">return</font> mErr[2];}
00338   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   ErrY()  <font class="keyword">const</font>     {<font class="keywordflow">return</font> mErr[2];}
00339   <font class="comment">/* DOCF: error on Fond_fit  */</font>
00340  <font class="keywordtype">double</font>&amp;         ErrFond()<font class="keyword">         </font>{<font class="keywordflow">return</font> mErr[mPSF-&gt;NParm()-1];}
00341   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   ErrFond()  <font class="keyword">const</font>  {<font class="keywordflow">return</font> mErr[mPSF-&gt;NParm()-1];}
00342   <font class="comment">/* DOCF: error on SigX  */</font>
00343  <font class="keywordtype">double</font>&amp;         ErrSigX()<font class="keyword">         </font>{<font class="keywordflow">return</font> mErr[3];}
00344   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   ErrSigX()  <font class="keyword">const</font>  {<font class="keywordflow">return</font> mErr[3];}
00345   <font class="comment">/* DOCF: error on SigY  */</font>
00346  <font class="keywordtype">double</font>&amp;         ErrSigY()<font class="keyword">         </font>{<font class="keywordflow">return</font> mErr[4];}
00347   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   ErrSigY()  <font class="keyword">const</font>  {<font class="keywordflow">return</font> mErr[4];}
00348  <font class="comment">/* DOCF: error on Rho  */</font>
00349   <font class="keywordtype">double</font>&amp;         ErrRho()<font class="keyword">          </font>{<font class="keywordflow">return</font> mErr[5];}
00350   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   ErrRho()   <font class="keyword">const</font>  {<font class="keywordflow">return</font> mErr[5];}
00351  <font class="comment">/* DOCF: $\chi^2$ of fit  */</font>
00352   <font class="keywordtype">double</font>&amp;         Xi2()<font class="keyword">             </font>{<font class="keywordflow">return</font> mXi2;}
00353   <font class="keywordtype">double</font> <font class="keyword">const</font>&amp;   Xi2()      <font class="keyword">const</font>  {<font class="keywordflow">return</font> mXi2;}
00354   
00355 <font class="comment">/* DOC All these parameters are re-naming of  {\tt Err(i)}. */</font>
00356 
00357 <font class="comment">/* DOC read and write are identical to that of SEStar */</font>
00358   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    <a class="code" href="class_sestar.html#a75">dump</a>(ostream&amp; s=cout) <font class="keyword">const</font> ;
00359   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    <a class="code" href="class_sestar.html#a74">dumpn</a>(ostream&amp; s=cout) <font class="keyword">const</font>;
00360 
00361   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    write(ostream&amp; s=cout) <font class="keyword">const</font>;
00362   <font class="keyword">virtual</font> <font class="keywordtype">void</font>    <a class="code" href="class_sestar.html#a76">writen</a>(ostream&amp; s=cout) <font class="keyword">const</font>;
00363 
00364 
00365   <font class="keyword">virtual</font> <font class="keywordtype">void</font>   Read(istream&amp; r, <font class="keyword">const</font> <font class="keywordtype">char</font> *Format, <font class="keywordtype">int</font> &amp; type_psf);
00366   <font class="keyword">static</font> PSFFitStar* <a class="code" href="class_sestar.html#d0">read</a>(istream&amp; r, <font class="keyword">const</font> <font class="keywordtype">char</font> *Format, PSF *mypsf); 
00367   <font class="keyword">static</font> PSFFitStar* <a class="code" href="class_sestar.html#d0">read</a>(istream&amp; r, <font class="keyword">const</font> <font class="keywordtype">char</font> *Format);
00368 
00369   <font class="keyword">const</font> <font class="keywordtype">char</font> * WriteHeader_(ostream &amp; pr = cout, <font class="keyword">const</font> <font class="keywordtype">char</font> *i= NULL) <font class="keyword">const</font>;
00370  
00371 
00372  <font class="comment">/* DOC //{\bf fitting of the PSF on an image}: //</font>
00373 <font class="comment">  virtual int     Fit(Image const&amp; img, </font>
00374 <font class="comment">Image const&amp; noiseimg, int lp=0);</font>
00375 <font class="comment"> */</font>
00376   <font class="keyword">virtual</font> <font class="keywordtype">int</font>     Fit(<a class="code" href="class_image.html">Image</a> <font class="keyword">const</font>&amp; img, <a class="code" href="class_image.html">Image</a> <font class="keyword">const</font>&amp; noiseimg, <font class="keywordtype">int</font> lp=0);
00377   <font class="comment">/* DOCF initialisation of the </font>
00378 <font class="comment">fit with SExtractor computed x, y, flux, fond, Mxx, Myy, </font>
00379 <font class="comment">Mxy of the star.  */</font>
00380  <font class="keyword">virtual</font> <font class="keywordtype">int</font>     IniFitSE(<font class="keywordtype">bool</font> fond_force=<font class="keyword">false</font>, <font class="keywordtype">double</font> fond=0., <font class="keywordtype">int</font> lp=0);
00381 <font class="comment">/* DOC // initialisation of the fit with x, y and a rough computation</font>
00382 <font class="comment">of the flux and background on the image. */</font>
00383   <font class="keyword">virtual</font> <font class="keywordtype">int</font>     IniFit(<a class="code" href="class_image.html">Image</a> <font class="keyword">const</font>&amp; img, <a class="code" href="class_image.html">Image</a> <font class="keyword">const</font>&amp; noiseimg, <font class="keywordtype">int</font> lp=0);
00384 <font class="keyword">protected</font>:
00385   <font class="keywordtype">double</font>          mXi2;
00386   <font class="keywordtype">double</font>*         mErr;
00387 
00388 <font class="keyword">private</font>:
00389 
00390   PSFFitStar&amp; operator=(<font class="keyword">const</font> PSFFitStar &amp;); 
00391 
00392 };
00393 
00394 
00395 
00396 
00397 
00398 
00399 <font class="comment">//********************   FIN DEFINITION PSFFFitStar   *********************</font>
00400 
00401 
00402 <font class="comment">/* what concerns the PSFFitStarList's : */</font>
00403 
00404 
00405 
00406 
00407 
00408 <font class="keyword">typedef</font> <a class="code" href="class_starlist.html">StarList&lt;PSFFitStar&gt;</a> PSFFitStarList;
00409 <font class="keyword">typedef</font> list&lt;PSFFitStar*&gt;::const_iterator PSFFitStarCIterator;
00410 <font class="keyword">typedef</font> list&lt;PSFFitStar*&gt;::iterator PSFFitStarIterator;
00411 
00412 
00413 
00414 <font class="comment">/*DOCF: to copy a SEStarList in a PSFFitStarList*/</font>
00415 <font class="keywordtype">int</font>
00416 Copy_SEtoPSFFit_StarList(<a class="code" href="class_starlist.html">SEStarList</a> &amp; stlse, PSFFitStarList &amp; stlfit, PSF *psf);
00417 
00418 <font class="keywordtype">int</font>
00419 Copy_BasetoPSFStarList(<a class="code" href="class_starlist.html">BaseStarList</a> &amp; stlse, <a class="code" href="class_starlist.html">PSFStarList</a> &amp; stlfit, 
00420                        PSF *psf);
00421 <font class="keywordtype">int</font>
00422 Copy_PSFFittoSEStarList(PSFFitStarList &amp; stlfit, <a class="code" href="class_starlist.html">SEStarList</a> &amp; stlse);
00423 
00424 <font class="keywordtype">int</font>
00425 Copy_PSFtoBaseStarList(<a class="code" href="class_starlist.html">BaseStarList</a> &amp; stlb, <a class="code" href="class_starlist.html">PSFStarList</a> &amp; stlfit);
00426 
00427 <font class="preprocessor">#endif </font><font class="comment">/* IS_IT_USEFUL */</font>
00428 
00429 
00430 <font class="preprocessor">#endif</font>
</font></pre></div><hr><address><small>Generated at Sun Feb 8 18:22:49 2004 for toads by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.6 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
