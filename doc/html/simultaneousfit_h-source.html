<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>simultaneousfit.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.6 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; <a class="qindexRef" doxygen="_cgi:http://ici.la.bas/toto/tata/search.cgi" href="http://ici.la.bas/toto/tata/search.cgi">Search</a> &nbsp; </center>
<hr><h1>simultaneousfit.h</h1><a href="simultaneousfit_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">// This may look like C code, but it is really -*- C++ -*-</font>
00002 <font class="preprocessor">#ifndef SIMULTANEOUSFIT__H</font>
00003 <font class="preprocessor"></font><font class="preprocessor">#define SIMULTANEOUSFIT__H</font>
00004 <font class="preprocessor"></font>
00005 <font class="keyword">const</font> <font class="keywordtype">int</font> FitFlux = 1;
00006 <font class="keyword">const</font> <font class="keywordtype">int</font> FitPos  = 2;
00007 <font class="keyword">const</font> <font class="keywordtype">int</font> FitGal  = 4;
00008 <font class="keyword">const</font> <font class="keywordtype">int</font> FitSky  = 8;
00009 
00010 <font class="preprocessor">#include "imagelist.h"</font>
00011 
00012 <font class="preprocessor">#include &lt;lafnames.h&gt;</font> 
00013 <font class="preprocessor">#include LA_GEN_MAT_DOUBLE_H</font>
00014 <font class="preprocessor"></font><font class="preprocessor">#include LA_VECTOR_DOUBLE_H </font>
00015 <font class="preprocessor"></font>
00028 <font class="keyword">class </font>VignetFit;
00029 <font class="keyword">class </font><a class="code" href="class_vignet.html">Vignet</a>;
00030 
00031 <font class="keyword">typedef</font> <font class="keyword">enum</font> {LevenbergMarquardt,
00032               NewtonRaphson} MinimMethod;
00033 
00034 <font class="keyword">typedef</font> ImageList&lt;VignetFit&gt;::iterator VignetFitIterator;
00035 <font class="keyword">typedef</font> ImageList&lt;VignetFit&gt;::const_iterator VignetFitCIterator;
00036 
<a name="l00038"></a><a class="code" href="class_simultaneousfit.html">00038</a> <font class="keyword">class </font><a class="code" href="class_simultaneousfit.html">SimultaneousFit</a> : <font class="keyword">public</font>  ImageList&lt;VignetFit&gt; {
00039 
00040   <font class="keywordtype">bool</font> refill;
00041   <font class="comment">// flag to check whether we fit the point source fluxes</font>
00042   <font class="keywordtype">bool</font> fit_flux;
00043   <font class="comment">// flag to check whether we fit the galaxy</font>
00044   <font class="keywordtype">bool</font> fit_gal;
00045   <font class="comment">// flag to check whether we fit the sky </font>
00046   <font class="keywordtype">bool</font> fit_sky;
00047   <font class="comment">// flag to check whether we fit the point source position</font>
00048   <font class="keywordtype">bool</font> fit_pos;
00049   <font class="comment">// b,</font>
00050   LaVectorDouble Vec;
00051   <font class="comment">// A,</font>
00052   LaGenMatDouble Mat;
00053   LaGenMatDouble MatGal;
00054   <font class="comment">// matrix sizes: number of fluxes to fit, pixels, and total matrix size</font>
00055   <font class="keywordtype">int</font> nfx,nfy,hfx,hfy;
00056   <font class="comment">// matrix indices where thigs are stored</font>
00057   <font class="keywordtype">int</font> fluxstart,galstart,skystart;
00058   <font class="keywordtype">int</font> xind,yind;
00059   <font class="keywordtype">int</font> fluxend,galend,skyend;
00060   <font class="comment">// scaling factor </font>
00061   <font class="keywordtype">double</font> scale,minscale;
00062   <font class="keywordtype">int</font> nparams,ndata,iter;
00063   <font class="keywordtype">double</font> chi2;
00064   <font class="comment">// returns the galaxy matrix index given pixel (i,j)</font>
00065   <font class="keyword">inline</font> <font class="keywordtype">int</font> galind(<font class="keyword">const</font> <font class="keywordtype">int</font> i, <font class="keyword">const</font> <font class="keywordtype">int</font> j) <font class="keyword">const</font>;
00066   <font class="comment">// matrix A and vector b filling routines</font>
00067   <font class="keywordtype">void</font> fillFluxFlux();
00068   <font class="keywordtype">void</font> fillFluxPos();
00069   <font class="keywordtype">void</font> fillFluxGal();
00070   <font class="keywordtype">void</font> fillFluxSky();
00071   <font class="keywordtype">void</font> fillPosPos();
00072   <font class="keywordtype">void</font> fillPosGal();
00073   <font class="keywordtype">void</font> fillPosSky();
00074   <font class="keywordtype">void</font> fillGalGal();
00075   <font class="keywordtype">void</font> fillGalSky();
00076   <font class="keywordtype">void</font> fillSkySky();
00077 
00078   <font class="keywordtype">bool</font> printlevel;
00079 
00080 <font class="keyword">public</font>:
00081   SimultaneousFit();
00082   ~SimultaneousFit();
00083   MinimMethod Minim;
00085   <font class="keywordtype">void</font> <a class="code" href="class_simultaneousfit.html#a2">FillMatAndVec</a>();
00087   <font class="keywordtype">bool</font> <a class="code" href="class_simultaneousfit.html#a3">Solve</a>(<font class="keyword">const</font> <font class="keywordtype">double</font> &amp;lambda=0,<font class="keyword">const</font> <font class="keywordtype">bool</font> invert=<font class="keyword">false</font>);
00089   <font class="keywordtype">bool</font> <a class="code" href="class_simultaneousfit.html#a4">IterateAndSolve</a>(<font class="keyword">const</font> <font class="keywordtype">int</font> MaxIterations, <font class="keyword">const</font> <font class="keywordtype">double</font> Epsilon=0.01);
00091   <font class="keywordtype">void</font> <a class="code" href="class_simultaneousfit.html#a5">AssignStar</a>();
00093   <font class="keywordtype">double</font> <a class="code" href="class_simultaneousfit.html#a6">ComputeChi2</a>();
00095   <font class="keywordtype">bool</font> <a class="code" href="class_simultaneousfit.html#a7">ApplyCorrections</a>(<font class="keyword">const</font> <font class="keywordtype">double</font> Factor=1);
00097   <font class="keywordtype">void</font> <a class="code" href="class_simultaneousfit.html#a8">MakeResidsAndWeights</a>();
00099   <font class="keywordtype">void</font> <a class="code" href="class_simultaneousfit.html#a9">MakePsfs</a>();
00101   <font class="keywordtype">void</font> <a class="code" href="class_simultaneousfit.html#a10">DoTheFit</a>(<font class="keyword">const</font> <font class="keywordtype">double</font> &amp;MaxScale=1);
00103   <font class="keywordtype">void</font> <a class="code" href="class_simultaneousfit.html#a11">SetWhatToFit</a>(<font class="keyword">const</font> <font class="keywordtype">int</font> ToFit = FitFlux | FitGal);
00105   <font class="keywordtype">void</font> <a class="code" href="class_simultaneousfit.html#a12">FindMinimumScale</a>(<font class="keyword">const</font> <font class="keywordtype">double</font> &amp;WorstSeeing);
00107   <font class="keywordtype">void</font> <a class="code" href="class_simultaneousfit.html#a13">MakeInitialModel</a>();
00109   <font class="keywordtype">void</font> <a class="code" href="class_simultaneousfit.html#a14">Resize</a>(<font class="keyword">const</font> <font class="keywordtype">double</font> &amp;ScaleFactor);
<a name="l00111"></a><a class="code" href="class_simultaneousfit.html#m1">00111</a>   VignetFit *VignetRef;
<a name="l00113"></a><a class="code" href="class_simultaneousfit.html#m2">00113</a>   <a class="code" href="class_vignet.html">Vignet</a> *galaxy;
00115   <font class="keywordtype">double</font> <a class="code" href="class_simultaneousfit.html#a15">GetGalaxyFlux</a>(<font class="keywordtype">double</font> &amp;VarGalFlux) <font class="keyword">const</font>;
00117   <font class="keywordtype">double</font> <a class="code" href="class_simultaneousfit.html#a16">GetZeroFlux</a>(<font class="keywordtype">double</font> &amp;VarZeroFlux) <font class="keyword">const</font>;
00119   <font class="keywordtype">void</font> <a class="code" href="class_simultaneousfit.html#a17">write</a>(<font class="keyword">const</font> string &amp;MiddleName) <font class="keyword">const</font>;
<a name="l00121"></a><a class="code" href="class_simultaneousfit.html#a18">00121</a>   <font class="keywordtype">double</font> <a class="code" href="class_simultaneousfit.html#a18">Chi2</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> chi2;}
00122   <font class="keywordtype">void</font> GetChi2(<font class="keywordtype">double</font> &amp;newchi2, <font class="keyword">const</font> <font class="keywordtype">double</font> &amp;oldchi2, <font class="keywordtype">double</font> &amp;lambda);
<a name="l00124"></a><a class="code" href="class_simultaneousfit.html#a20">00124</a>   <font class="keywordtype">int</font> <a class="code" href="class_simultaneousfit.html#a20">Dof</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> nparams-ndata;}
<a name="l00126"></a><a class="code" href="class_simultaneousfit.html#a21">00126</a>   <font class="keywordtype">double</font> <a class="code" href="class_simultaneousfit.html#a21">Scale</a>()<font class="keyword"> const </font>{<font class="keywordflow">return</font> scale;}
00127 };
00128 
00129 <font class="preprocessor">#endif // SIMULTANEOUSFIT__H</font>
00130 <font class="preprocessor"></font>
00131 
00132 
</pre></div><hr><address><small>Generated at Sun Feb 8 18:22:49 2004 for toads by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.6 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
